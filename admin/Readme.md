# Administrator scripts

Software requirements:

- python 2.6/2.7 flavors
- git >= 1.8.5

## Creating a repository for analyzers

### Purpose

In the Github ILDAnaSoft, a Skeleton repository is used as template for creating new repositories. 
The script *create-repository.py* will take care of:

- Creating the new repository (optional)
- Add a the analyzer as collaborator for this repository (optional)
- Cloning the Skeleton repository locally
- Formating the skeleton repository
- Pushing the formatted result to the created repository

Running this script requires to have generated a github token. See the dedicated section below.

The help message of the *create-repository.py* gives the following:

```shell
./create-repository.py --help
usage: Admin tool for ILDAnaSoft github collaboration [-h]
                                                      [-v {DEBUG,INFO,WARNING,ERROR,CRITICAL}]
                                                      [--repository REPOSITORY]
                                                      [--benchmark]
                                                      [--no-create]
                                                      [--description DESCRIPTION]
                                                      [--user USER]

optional arguments:
  -h, --help            show this help message and exit
  -v {DEBUG,INFO,WARNING,ERROR,CRITICAL}, --print-level {DEBUG,INFO,WARNING,ERROR,CRITICAL}
                        Verbosity DEBUG, INFO, WARNING, ERROR, CRITICAL
  --repository REPOSITORY
                        The new repository name
  --benchmark           Whether the repository is an ILD physics benchmark (add ILDbench_ to repository name)
  --no-create           Whether the skip repository creation
  --description DESCRIPTION
                        The repository description
  --user USER           The github user name of the developer
```

The options `--repository` and `--description` are required whereas the options `--benchmark`, `--no-create` and `--user` are optional.

### Getting a Github token

Running the *create-repository.py* script requires a secure access to Github in order to be logged-in and perform admin operations on repositories. **Without this login operation, no script will work!**. Also if you are not administrator of the ILDAnaSoft organization, you won't be able to run any script.

The simplest way to login by command line, is to use a so-called *Github token*, a set of characters like e.g `45DFdfv58dgbv45DFVwbfcb`. A token can be generated by Github: 

- Go to the Github website and first log-in.
- Go to [https://github.com/settings/tokens](https://github.com/settings/tokens).
- Click on the button `Generate new token`.
- You then have to fill 
   - a description (what ever you want)
   - the scopes of this token. Simply check `public_repo` here
- Click on `Generate token` at the bottom to get your token
- You will end up with a key such as `4526148359f7821c46c5bbbfaba801519f01ca5f`. **Be careful with this key, this is an equivalent to a password and thus should be kept privately**. Copy this key, with a `right click -> copy`. 
- Create a local file called `GitTokens.py` with the following content:

```python
GITHUBTOKEN = "your_token"
``` 

where your_token is the key you've just copied.

You're done !

### Examples of repository creation

Here after a few example of how to use the *create-repository.py* script. Note that before running this script, the file `GitTokens.py` (see section above) as to be in the local directory where you run the script. For example from the ILDDoc/admin directory:

```shell
$ pwd 
/home/eteremi/soft/ILDDoc/admin
$ ls
create-repository.py  GitTokens.py  ild
```

The following command is the minimal command to create a new repository:

```shell
./create-repository.py --repository HiggsAnalysis --description "Physics analysis for Higgs channel"
```

If the repository already exists and is empty, you can skip the repository creation: 

```shell
./create-repository.py --no-create --repository HiggsAnalysis --description "Physics analysis for Higgs channel"
```

If you want to give push righta to a particular person on creation you need the github username pof this person. For example, if you want to give push rights to `popey`:

```shell
./create-repository.py --user popey --repository HiggsAnalysis --description "Physics analysis for Higgs channel"
```

If the repository is an ILD physics benchmark, you can use the option `--benchmark`. It ill just prepend the repository name with "ILDbench_". Example for the ILD physics benchmark on WIMP search:

```shell
./create-repository.py --repository WIMP --description "WIMP search at the ILC with the ILD detector" --benchmark
```

This will create the repository "ILDAnasoft/ILDbench_WIMP".






